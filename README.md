Flood Risk Prediction System
Overview:
The Flood Risk Prediction System is a machine learning project that predicts flood risk levels based on environmental and geographical features. It uses a custom neural network (FloodNet) implemented in PyTorch, trained on a user-generated dataset (flood_risk_dataset_final.csv). The system processes numerical, categorical, and text-based features to classify flood risk into predefined categories (e.g., Low, Medium, High). It includes data preprocessing, model training, evaluation, and an interactive command-line interface for real-time flood risk predictions.The project handles imbalanced data using a weighted random sampler, employs early stopping to prevent overfitting, and provides detailed validation and testing metrics (F1 score). The interactive interface allows users to input environmental data and receive flood risk predictions with confidence scores and a probability breakdown.
 
 
 
FeaturesData Preprocessing: Handles numerical (e.g., Elevation, Rainfall), ordinal (e.g., Vegetation, Urbanization), one-hot encoded (e.g., Soil, Wetlands), and text (ProximityToWaterBody) features.
 
Outlier Handling: Clips and log-transforms numerical features to manage outliers.
 
Class Imbalance: Uses WeightedRandomSampler to address imbalanced flood risk classes.
 
Model Architecture: A custom PyTorch neural network (FloodNet) with embedding layers for categorical features and fully connected layers for classification.
 
Evaluation: Uses weighted F1 score for validation and testing, with a confusion matrix visualization.
 
Interactive Predictions: Allows users to input environmental data and receive flood risk predictions with confidence scores.
 
Input Validation: Ensures user inputs match valid categories, with suggestions for close matches.
 
PrerequisitesPython: Version 3.8 or higher
 
Libraries:numpy
 
Pandas
 
Torch
 
Scikit-learn
 
Matplotlib
 
 
Hardware: GPU recommended for faster training (CUDA-compatible), but CPU is supported.
 
 
 
Install the required libraries using:bash
 
 
 
Pip install numpy pandas torch scikit-learn matplotlib
Dataset
The project uses a custom dataset (flood_risk_dataset_final.csv) generated by the user. The dataset should contain the following columns:Numerical Features: Elevation, Rainfall
 
Ordinal Features: Vegetation, Urbanization, Drainage, Slope, StormFrequency, Deforestation, Infrastructure, Encroachment, Season
 
One-Hot Encoded Features: Soil, Wetlands
 
Text Feature: ProximityToWaterBody
 
Target: FloodRisk (categorical, e.g., Low, Medium, High)
Install dependencies
Pip install -r requirements.txt
 
Run the script:
Python cmodel_1.py
 
Usage
The script performs the following steps when executed:Loads and Preprocesses Data: Reads the dataset, handles outliers, and encodes features.
 
Splits Data: Divides the dataset into training (80%), validation (10%), and test (10%) sets with stratified sampling.
 
Trains the Model: Trains the FloodNet model for up to 40 epochs with early stopping (patience=6) based on validation F1 score.
 
Evaluates the Model: Computes the weighted F1 score on the test set and displays a confusion matrix.
 
Interactive Prediction: Enters a loop where users can input environmental data to predict flood risk.
 
 
Running the Scriptbash
 
 
 
Python cmodel_1.py
 
 
 
The script will train the model, save the best model weights (best_floodnet_model.pth), and display validation and test metrics.
 
After training, it enters an interactive mode where you can input environmental data to predict flood risk.
 
Type help during input prompts to see valid options for categorical features.
 
Press Ctrl+C or answer No to the ‚Äúpredict again‚Äù prompt to exit.
 
Example interaction
üåä FLOOD RISK PREDICTION SYSTEM üåä
üìã Valid options for each feature:
Vegetation: Dense, Sparse, Moderate, Missing
Urbanization: Low, Medium, High, Missing
‚Ä¶
Enter environmental details to predict flood risk:
(Type ‚Äòhelp‚Äô to see valid options for any field)
Vegetation: Dense
Urbanization: Low
‚Ä¶
Rainfall (numeric): 50
Elevation (numeric): 100
 
üåä Predicted Flood Risk Level: Low
üìä Confidence: 92.3%
üìà Risk Breakdown:
  Low: 92.3%
  Medium: 6.5%
  High: 1.2%
 
Would you like to predict again? (Yes/No): No
Goodbye! üëã
 
Model ArchitectureThe FloodNet model processes:Text Feature: Embedded into an 8-dimensional vector.
 
Ordinal Features: Each embedded into a 4-dimensional vector.
 
One-Hot Features: Passed directly as binary vectors.
 
Numerical Features: Scaled and concatenated with other features.
 
 
 
The concatenated features are fed through a neural network with:Input layer: Size depends on the number of features.
 
Hidden layers: 128 units (ReLU, 30% dropout), 64 units (ReLU, 10% dropout).
 
Output layer: Number of flood risk classes.
 
 
Created By: Mobolaji Opeyemi Bolatito
 
Contact: opeblow2021@gmail.com
 
